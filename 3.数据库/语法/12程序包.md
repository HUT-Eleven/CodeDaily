--创建包，
--声明一个函数，根据员工编号，返回员工是否存在；
--声明一个过程，根据员工编号查询员工是否存在，存在返回‘员工姓名’,否则‘该员工不存在’

--创建包规范
create or replace  package my_package
is
    --声明变量
    v_A  number:=10;
    
    --声明ref游标类型（这里的声明好像没意义）
    --type type_obj is ref cursor;
    
    --定义游标规范
    cursor cur_emp return  emp%rowtype;
    
    --声明一个函数，根据员工编号，返回员工是否存在；（函数要有return）
    function  getCountByNo (v_empno emp.empno%type) return  number;
    
    --声明一个过程，根据员工编号查询员工是否存在，存在返回‘员工姓名’,否则‘该员工不存在’
    procedure getDnameByNo (v_empno emp.empno%type,v_msg  out  varchar2);

end;

--创建包主体
create or replace package body  my_package
is
    --声明变量
    v_B  number:=20;
    
    --对包规范声明的游标进行具体的定义
    	
    cursor cur_emp return  emp%rowtype is select * from emp;
    
    --声明一个函数，根据员工编号，返回员工是否存在；
    function  getCountByNo (v_empno emp.empno%type) return  number
    is
        --声明变量
        v_count number;      
              
    begin
           --根据员工统计查询出来的行数
           select count(1) into v_count from emp where empno =v_empno;   
           
           --返回
           return v_count;
    end;

     --声明一个过程，根据员工编号查询员工是否存在，存在返回‘员工姓名’,否则‘该员工不存在’
    procedure getDnameByNo (v_empno emp.empno%type,v_msg  out  varchar2)
    is

    begin
              --根据员工编号判断员工是否存在
              if(getCountByNo(v_empno) >0 ) then
                   --根据员工编号查询出员工姓名
                   select ename into v_msg from emp where empno =v_empno;   
              else
                  v_msg:='该员工不存在';
              end if;
    end;

begin
    
--包主体begin部分只会执行一次；
    for v_i in 1..10 loop
        
        dbms_output.put_line('begin：'||v_i);  
        
    end loop;

end;

--调用程序包里面的过程
declare 
    v_msg varchar2(30);

begin
    my_package.getDnameByNo(77788,v_msg);
    
    dbms_output.put_line(v_msg);
    
    --调用包规范声明变量
    dbms_output.put_line('v_A:'|| my_package.v_A);--包规范声明的都是公共的
    
    --调用包主体声明变量
    dbms_output.put_line('v_B:'|| my_package.v_B);--包主体声明的都是私有的
end;

--调用程序包定义的游标
declare


begin
    --通过for循环程序包里面的游标
    for v_e  in  my_package.cur_emp loop
            
        --打印每一行数据
        dbms_output.put_line('员工编号:'|| v_e.empno || '员工姓名：' || v_e.ename);
    end loop;

end;

select my_package.getCountByNo(77788) from dual;