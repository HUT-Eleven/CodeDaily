--静态游标：     

 --隐式游标：     
      declare
      
     begin
    	--根据员工编号修改员工福利
          update  emp set comm =1000 ;
     	第一种--%found ：dml 语句影响一行或者多行时返回true；
      	if(sql%found) then
          	dbms_output.put_line('%found：true' );          
      	else
         	dbms_output.put_line('%found：false' ); 
     	end if;
      
      第二种--%notfound ： dml语句没有影响任何行时返回true；
      if(sql%notfound) then
          dbms_output.put_line('%notfound：true' );   
      else
          dbms_output.put_line('%notfound：false' );       
      end if;         
       update  emp set comm =1000  where empno =7369;
      第三种--%rowcount :返回dml语句受影响的行数
      dbms_output.put_line('受影响的行数'|| sql%rowcount);  
      
      第四种--%isopen :判断游标是否打开，对隐式游标而言永远都是false
      if(sql%isopen) then
           dbms_output.put_line('游标打开');          
      else
           dbms_output.put_line('游标关闭');
      end if;
     end;


--显示游标：     

      declare
     	 	--声明游标
      		cursor cur_emp   is select * from emp ;
      		--声明行类型的变量
      		v_emp emp%rowtype;
    begin
            --打开游标      
            open cur_emp;
            --通过loop循环游标
            loop
                   --从游标里面提取一行数据
                    fetch  cur_emp   into  v_emp;
                   --循环退出条件
                  exit when cur_emp%notfound; --判断的是有没有从游标里面提取到结果（fetch到结果）
                  --打印员工信息
                  dbms_output.put_line('员工编号：'|| v_emp.empno || '员工姓名：'|| v_emp.ename);
      		end loop;
      
      --关闭游标
      close cur_emp;
      
       dbms_output.put_line('==========================================================');
      
      --打开游标
      open cur_emp;
      
      --从游标里面提取一行数据
      fetch  cur_emp into v_emp;
      
      --通过while循环游标
      while(cur_emp%found) loop
           --打印员工信息
          dbms_output.put_line('员工编号：'|| v_emp.empno || '员工姓名：'|| v_emp.ename);                 
      
          --从游标里面提取一行数据
           fetch  cur_emp into v_emp;
           
      end loop;
      
      --关闭游标
      close  cur_emp;
      
     dbms_output.put_line('==========================================================');
     
     --打开游标
     --open cur_emp;
     if(cur_emp%isopen) then
           dbms_output.put_line('循环外面游标打开');             
     else
           dbms_output.put_line('循环外面游标没有打开');       
     end if;
    
      --for in 循环游标（自动开闭游标）
      for v_e  in cur_emp  loop
         /*if(cur_emp%isopen) then
           dbms_output.put_line('循环里面游标打开');             
         else
               dbms_output.put_line('循环里面游标没有打开');       
         end if;*/
         if(v_e.empno =7788) then 
          continue;  --退出本轮循环，执行下一轮循环       
           end if;
                  --打印员工信息
          dbms_output.put_line('员工编号：'|| v_e.empno || '员工姓名：'|| v_e.ename);  
      
      end loop;
      
      if(cur_emp%isopen) then
           dbms_output.put_line('循环后面游标打开');             
     else
           dbms_output.put_line('循环后面游标没有打开');       
     end if;
      
      --关闭游标
      --close  cur_emp;
      end; 
    

​      
       --查询员工薪资，根据薪资加福利
    declare
          --声明游标
          cursor cur_emp is select * from emp;
          --声明行类型变量
      v_emp emp%rowtype;
      v_changeComm  number(10):=0;
      begin
          --打开游标
          open cur_emp;
            --循环游标
      loop
           --从游标里面提取数据
           fetch cur_emp into v_emp;
           
           --循环退出条件
           exit when cur_emp%notfound;
           
           --进行加福利操作
           
           if(v_emp.sal <1000) then
               v_changeComm :=100;
           elsif(v_emp.sal between 1000 and 1999) then
               v_changeComm :=80;                     
           else
               v_changeComm :=50;    
           end if;
           
           update emp set comm =nvl(comm,0)+v_changeComm where empno = v_emp.empno;       
      
      end loop;
      
      --关闭游标
      close cur_emp;
      end;
