    --1.创建函数，根据部门的编号，返回部门名称
    CREATE OR REPLACE FUNCTION getDnameByDno(v_deptno dept.deptno%type)
    RETURN dept.dname%Type
    AS
           v_dname dept.dname%TYPE;
    BEGIN
           SELECT dname INTO v_dname FROM dept WHERE deptno=v_deptno;    
           RETURN v_dname;
           EXCEPTION
                  WHEN OTHERS THEN RETURN v_deptno;
    END;
    --1.1通过Sql语句调用函数
    SELECT empno,ename,sal,deptno,getDnameBydno(deptno) "部 门名" FROM emp;
    --1.2通过PL/SQL块调用
    DECLARE
        v_dname dept.dname%TYPE;
    BEGIN 
        v_dname := getDnameByDno(10);
        dbms_output.put_line(v_dname);
    END;

​      
    

```
--2.创建函数，根据部门的编号，查询部门平均薪资，人数，薪资总和
    CREATE OR REPLACE FUNCTION getempInfoByNo(v_deptno dept.deptno%TYPE)
    RETURN SYS_REFCURSOR
    IS
           cur_dept SYS_REFCURSOR;
    BEGIN
           OPEN cur_dept FOR SELECT AVG(sal),COUNT(1),SUM(sal) FROM emp WHERE deptno=v_deptno;
           RETURN cur_dept;
    END;
    --用PL/SQL块调用   
    DECLARE
        --声明游标
        cur_emp SYS_REFCURSOR;
        v_avgSal number(10,2);
        v_count number;
        v_sumSal number(10,2);
    BEGIN
    	--这里声明的游标已经不用在open了，因为函数中返回的游标已经是打开了，这里相当于传递了引用，间接的打开了游标。
        cur_emp:=getempInfoByNo(30);
        IF (cur_info%ISOPEN)THEN
          	dbms_output.put_line('循环外面游标打开');             
        else
       		dbms_output.put_line('循环外面游标没有打开');  
        END IF; 
        fetch cur_emp into v_avgSal,v_count,v_sumSal;
        dbms_output.put_line('平均薪资：'|| v_avgSal || '人数：'||v_count || '总和：'|| v_sumSal);
        close cur_emp;
    END;
          
```


